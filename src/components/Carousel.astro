---
import CarouselNavButton from "./CarouselNavButton.astro";
import Thumbnail from "./Thumbnail.astro";
---

<div class="carousel" aria-label="product image gallery" role="region">
  <div class="carousel-slide">
    <button class="open-lightbox" aria-label="Open the lightbox"></button>

    <div class="carousel-main-image-wrapper">
      <img
        class="carousel-main-image"
        src="/assets/images/image-product-1.jpg"
        alt="1. A single beige and white sneaker with its sole facing upwards, set against a dual-tone background with orange at the top and yellow at the bottom."
        data-number="1"
        aria-live="polite"
      />
    </div>

    <CarouselNavButton
      direction="previous"
      ariaLabel="Previous image"
      hideOnDesktop={true}
      transform="-50%"
      position="-0.5rem"
      label="carousel"
    />

    <CarouselNavButton
      direction="next"
      ariaLabel="Next image"
      hideOnDesktop={true}
      transform="-50%"
      position="-0.5rem"
      label="carousel"
    />
  </div>

  <!-- Thumbnails below the main carousel (Tablet and Desktop only) -->
  <Thumbnail hideOnMobile={true} />
</div>

<style lang="scss">
  @use "../styles/abstracts/" as *;

  .carousel {
    display: flex;
    flex-direction: column;
    gap: $size-7;
  }

  .carousel-slide {
    position: relative;
  }

  .carousel-main-image-wrapper {
    margin-left: #{-$size-6};
    margin-right: #{-$size-6};

    @include mq(small) {
      outline: 6px solid transparent;
      border-radius: $border-radius-2;
      margin: 0;
    }

    & img {
      position: relative;
      width: 100%;
      height: 300px;
      object-fit: cover;
      z-index: 2;
      transition: opacity 0.5s ease-in-out;

      @include mq(small) {
        height: 100%;
        border-radius: $border-radius-2;
      }

      @include mq(medium) {
        z-index: 0;
      }
    }
  }

  .open-lightbox {
    outline: 0;
    position: absolute;
    inset: 0;
    @include mq(medium) {
      z-index: 1;
    }
  }

  .open-lightbox:focus-visible ~ .carousel-main-image-wrapper {
    outline-color: $color-primary-500;
    outline-style: dotted;
    outline-offset: 8px;
  }
</style>
